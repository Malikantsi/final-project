import{f as T,s as B,u as w}from"./utils-Ds_x5a_2.js";document.addEventListener("DOMContentLoaded",function(){let n=1;const g=9;let s=[],o=[];const E=document.querySelector(".products-grid"),y=document.querySelector("#prev-page"),f=document.querySelector("#next-page"),C=document.querySelector("#page-info"),v=document.querySelector("#search-input"),I=document.querySelector("#search-btn"),b=document.querySelector("#category-filter"),P=document.querySelector("#price-filter"),_=document.querySelector("#sort-by");function m(r){const t=document.createElement("div");t.className="api-alert",t.textContent=r,document.body.prepend(t),setTimeout(()=>t.remove(),3e3)}document.addEventListener("DOMContentLoaded",async function(){const r=document.querySelector(".products-grid"),t=document.getElementById("loading");t.style.display="block",r.innerHTML="";try{let a=await k();(!a||a.length===0)&&(a=S(),m("Showing demo data - API unavailable")),d(a),localStorage.setItem("cachedToys",JSON.stringify(a))}catch(a){console.error("Error:",a),d(),m("⚠️ Using offline demo data")}finally{t.style.display="none"}});async function k(){var r;return await fetch("https://scout-amazon-data.p.rapidapi.com/Amazon-Search-Data?query=toys&region=US&sort_by=RELEVANCE&page=1",{method:"GET",headers:{"X-RapidAPI-Key":"e60a9d86cemsh8b4e1f6d4cef00fp165b60jsneed46343db87","X-RapidAPI-Host":"scout-amazon-data.p.rapidapi.com"}}).then(t=>t.json()).then(t=>{r=t,t&&t.data&&(container.innerHTML=t.data.map(a=>`
                    <div >
                        <img src="${a.image}" alt="${a.title}" style="width:100%; height:auto;" />
                        <h4>True${a.title}</h4>
                        <p>Price: ${a.price}</p>
                    </div>`).join(""))}).catch(t=>console.error(t)),r.products}async function q(){const r=localStorage.getItem("cachedProducts");r&&(s=JSON.parse(r),o=[...s],d());const t=await k();t.length>0?(s=t,o=[...t],localStorage.setItem("cachedProducts",JSON.stringify(t))):(s=S(),o=[...s],m("⚠️ Using demo data - API may be unavailable")),d(),w()}function S(){return[{id:1,title:"LEGO Classic Creative Brick Box",price:29.99,description:"Build anything you can imagine with these colorful bricks!",category:"building",ageGroup:"5-8",rating:{rate:4.8,count:120},image:"images/lego-bricks.jpg",stock:35,materials:"Plastic",safetyInfo:"Non-toxic, BPA-free materials"},{id:2,title:"Cuddly Teddy Bear",price:19.99,description:"Soft and huggable teddy bear for bedtime comfort",category:"plush",ageGroup:"0-1",rating:{rate:4.5,count:85},image:"images/teddy-bear.jpg",stock:42,materials:"Plush fabric, Polyester filling",safetyInfo:"Machine washable, hypoallergenic"},{id:3,title:"Junior Scientist Kit",price:34.99,description:"Fun experiments to spark scientific curiosity",category:"educational",ageGroup:"8-12",rating:{rate:4.7,count:65},image:"images/science-kit.jpg",stock:18,materials:"Plastic, Paper",safetyInfo:"Adult supervision recommended"}]}function d(){const r=(n-1)*g,t=r+g,a=o.slice(r,t);console.log("Fixed Product Price that was causing display errors"),E.innerHTML=a.map(e=>`
            <div class="product-card">
                <div class="product-image">
                    <img src="${e.product_image}" alt="${e.product_title}" onerror="this.src='images/placeholder-toy.jpg'">
                    <a href="/src/products/product-details.html" class="quick-view" data-id="${e.asin}">Quick View</a>
                </div>
                <div class="product-info">
                    <h3>${e.product_title}</h3>
                    <div class="product-price">${T(e.product_price.replace("$",""))}</div>
                    <div class="product-rating">
                        ${"★".repeat(Math.round(e.product_star_rating))}${"☆".repeat(5-Math.round(e.product_star_rating))} 
                        <span class="review-count">(${e.product_num_ratings})</span>
                    </div>
                    <button class="btn btn-primary add-to-cart" data-id="${e.asin}" id="${e.asin}" name="${e.asin}">
                        Add to Cart
                    </button>
                </div>
            </div>
        `).join("");const i=Math.ceil(o.length/g);C.textContent=`Page ${n} of ${i}`,y.disabled=n===1,f.disabled=n===i||i===0,document.querySelectorAll(".add-to-cart").forEach(e=>{e.addEventListener("click",A)}),document.querySelectorAll(".quick-view").forEach(e=>{e.addEventListener("click",x)})}function l(){const r=v.value.toLowerCase(),t=b.value,a=P.value,i=_.value;switch(o=s.filter(e=>{var c=e.product_price.substring(1,e.product_price.length);const u=e.product_title.toLowerCase().includes(r)||e.product_title.toLowerCase().includes(r),p=!t||e.category===t;let h=!0;if(a){const[L,$]=a.split("-").map(Number);$?h=c>=L&&c<=$:h=c>=L}return u&&p&&h}),i){case"price-low":o.sort((e,c)=>{const u=parseFloat(e.product_price.replace("$",""))||0,p=parseFloat(c.product_price.replace("$",""))||0;return u-p});break;case"price-high":o.sort((e,c)=>{const u=parseFloat(e.product_price.replace("$",""))||0,p=parseFloat(c.product_price.replace("$",""))||0;return u-p});break;case"rating":o.sort((e,c)=>c.product_num_ratings-e.product_num_ratings);break;case"newest":o.sort((e,c)=>c.asin-e.asin);break;default:o.sort((e,c)=>c.product_star_rating*c.product_num_ratings-e.product_star_rating*e.product_num_ratings);break}n=1,d()}function x(r){const t=r.target.dataset.id;window.location.href=`product-detail.html?id=${t}`}function A(r){var t=r.target.id;const a=s.find(c=>c.asin===t);try{console.log(a),B("cart",a),w()}catch(c){console.log(c)}const i=r.target,e=i.textContent;i.textContent="Added!",i.classList.add("added"),setTimeout(()=>{i.textContent=e,i.classList.remove("added")},2e3)}y.addEventListener("click",()=>{n>1&&(n--,d())}),f.addEventListener("click",()=>{const r=Math.ceil(o.length/g);n<r&&(n++,d())}),v.addEventListener("keyup",r=>{r.key==="Enter"&&l()}),I.addEventListener("click",l),b.addEventListener("change",l),P.addEventListener("change",l),_.addEventListener("change",l),q()});
