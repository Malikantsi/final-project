import{s as M,f as T,a as B,u as E}from"./utils-BLfInb8w.js";document.addEventListener("DOMContentLoaded",()=>{const c=document.querySelector(".mobile-menu-btn"),s=document.querySelector(".nav-menu");c&&s?M(c,s):console.warn("Mobile menu elements not found.")});document.addEventListener("DOMContentLoaded",function(){let c=1;const s=9;let d=[],n=[];const $=document.querySelector(".products-grid"),y=document.querySelector("#prev-page"),f=document.querySelector("#next-page"),C=document.querySelector("#page-info"),v=document.querySelector("#search-input"),q=document.querySelector("#search-btn"),b=document.querySelector("#category-filter"),P=document.querySelector("#price-filter"),_=document.querySelector("#sort-by");function m(r){const t=document.createElement("div");t.className="api-alert",t.textContent=r,document.body.prepend(t),setTimeout(()=>t.remove(),3e3)}document.addEventListener("DOMContentLoaded",async function(){const r=document.querySelector(".products-grid"),t=document.getElementById("loading");t.style.display="block",r.innerHTML="";try{let a=await S();(!a||a.length===0)&&(a=k(),m("Showing demo data - API unavailable")),l(a),localStorage.setItem("cachedToys",JSON.stringify(a))}catch(a){console.error("Error:",a),l(),m("⚠️ Using offline demo data")}finally{t.style.display="none"}});async function S(){var r;return await fetch("https://scout-amazon-data.p.rapidapi.com/Amazon-Search-Data?query=toys&region=US&sort_by=RELEVANCE&page=1",{method:"GET",headers:{"X-RapidAPI-Key":"e60a9d86cemsh8b4e1f6d4cef00fp165b60jsneed46343db87","X-RapidAPI-Host":"scout-amazon-data.p.rapidapi.com"}}).then(t=>t.json()).then(t=>{r=t,t&&t.data&&(container.innerHTML=t.data.map(a=>`
                    <div >
                        <img src="${a.image}" alt="${a.title}" style="width:100%; height:auto;" />
                        <h4>True${a.title}</h4>
                        <p>Price: ${a.price}</p>
                    </div>`).join(""))}).catch(t=>console.error(t)),r.products}async function I(){const r=localStorage.getItem("cachedProducts");r&&(d=JSON.parse(r),n=[...d],l());const t=await S();t.length>0?(d=t,n=[...t],localStorage.setItem("cachedProducts",JSON.stringify(t))):(d=k(),n=[...d],m("⚠️ Using demo data - API may be unavailable")),l(),E()}function k(){return[{id:1,title:"LEGO Classic Creative Brick Box",price:29.99,description:"Build anything you can imagine with these colorful bricks!",category:"building",ageGroup:"5-8",rating:{rate:4.8,count:120},image:"images/lego-bricks.jpg",stock:35,materials:"Plastic",safetyInfo:"Non-toxic, BPA-free materials"},{id:2,title:"Cuddly Teddy Bear",price:19.99,description:"Soft and huggable teddy bear for bedtime comfort",category:"plush",ageGroup:"0-1",rating:{rate:4.5,count:85},image:"images/teddy-bear.jpg",stock:42,materials:"Plush fabric, Polyester filling",safetyInfo:"Machine washable, hypoallergenic"},{id:3,title:"Junior Scientist Kit",price:34.99,description:"Fun experiments to spark scientific curiosity",category:"educational",ageGroup:"8-12",rating:{rate:4.7,count:65},image:"images/science-kit.jpg",stock:18,materials:"Plastic, Paper",safetyInfo:"Adult supervision recommended"}]}function l(){const r=(c-1)*s,t=r+s;var a=n.slice(r,t);console.log("Fixed Product Price that was causing display errors"),$.innerHTML=a.map(e=>`
            <div class="product-card">
                <div class="product-image">
                    <img src="${e.product_image}" alt="${e.product_title}" onerror="this.src='images/placeholder-toy.jpg'">
                    <a href="/src/products/product-details.html" class="quick-view" data-id="${e.asin}">Quick View</a>
                </div>
                <div class="product-info">
                    <h3>${e.product_title}</h3>
                    <div class="product-price">${T(e.product_price.replace("$",""))}</div>
                    <div class="product-rating">
                        ${"★".repeat(Math.round(e.product_star_rating))}${"☆".repeat(5-Math.round(e.product_star_rating))} 
                        <span class="review-count">(${e.product_num_ratings})</span>
                    </div>
                    <button class="btn btn-primary add-to-cart" data-id="${e.asin}" id="${e.asin}" name="${e.asin}">
                        Add to Cart
                    </button>
                </div>
            </div>
        `).join("");const i=Math.ceil(n.length/s);C.textContent=`Page ${c} of ${i}`,y.disabled=c===1,f.disabled=c===i||i===0,document.querySelectorAll(".add-to-cart").forEach(e=>{e.addEventListener("click",A)}),document.querySelectorAll(".quick-view").forEach(e=>{e.addEventListener("click",x)})}function u(){const r=v.value.toLowerCase(),t=b.value,a=P.value,i=_.value;switch(n=d.filter(e=>{var o=e.product_price.substring(1,e.product_price.length);const p=e.product_title.toLowerCase().includes(r)||e.product_title.toLowerCase().includes(r),g=!t||e.category===t;let h=!0;if(a){const[L,w]=a.split("-").map(Number);w?h=o>=L&&o<=w:h=o>=L}return p&&g&&h}),i){case"price-low":n.sort((e,o)=>{const p=parseFloat(e.product_price.replace("$",""))||0,g=parseFloat(o.product_price.replace("$",""))||0;return p-g});break;case"price-high":n.sort((e,o)=>{const p=parseFloat(e.product_price.replace("$",""))||0,g=parseFloat(o.product_price.replace("$",""))||0;return p-g});break;case"rating":n.sort((e,o)=>o.product_num_ratings-e.product_num_ratings);break;case"newest":n.sort((e,o)=>o.asin-e.asin);break;default:n.sort((e,o)=>o.product_star_rating*o.product_num_ratings-e.product_star_rating*e.product_num_ratings);break}c=1,l()}function x(r){const t=r.target.dataset.id;window.location.href=`product-detail.html?id=${t}`}function A(r){var t=r.target.id;const a=d.find(o=>o.asin===t);try{console.log(a),B("cart",a),E()}catch(o){console.log(o)}const i=r.target,e=i.textContent;i.textContent="Added!",i.classList.add("added"),setTimeout(()=>{i.textContent=e,i.classList.remove("added")},2e3)}y.addEventListener("click",()=>{c>1&&(c--,l())}),f.addEventListener("click",()=>{const r=Math.ceil(n.length/s);c<r&&(c++,l())}),v.addEventListener("keyup",r=>{r.key==="Enter"&&u()}),q.addEventListener("click",u),b.addEventListener("change",u),P.addEventListener("change",u),_.addEventListener("change",u),I()});
